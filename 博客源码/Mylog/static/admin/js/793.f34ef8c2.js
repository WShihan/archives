"use strict";(self["webpackChunkmy_app_vue"]=self["webpackChunkmy_app_vue"]||[]).push([[793],{2793:function(t,e,l){l.r(e),l.d(e,{default:function(){return f}});var s=l(3396),i=l(9242),o=l(7139);const a={class:"drafts"},n={style:{width:"100%","margin-bottom":"20px"}},d={class:"btns",style:{display:"flex","justify-content":"center","align-items":"center",gap:"1rem"}};function r(t,e,l,r,u,g){const h=(0,s.up)("CustomTable"),m=(0,s.up)("Refresh"),c=(0,s.up)("wsh-button"),p=(0,s.up)("Dialog"),f=(0,s.Q2)("loading");return(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",a,[(0,s.Wm)(h,{datas:u.drafts,onSelect:g.selectRow,total:u.total,props:u.propMap},null,8,["datas","onSelect","total","props"]),(0,s.Wm)(m,{onRefresh:g.initBlogs},null,8,["onRefresh"]),(0,s.Wm)(i.uT,{name:"fade"},{default:(0,s.w5)((()=>[u.dialogVisible?((0,s.wg)(),(0,s.j4)(p,{key:0,title:"草稿快捷操作",onClose:e[0]||(e[0]=t=>u.dialogVisible=!1)},{body:(0,s.w5)((()=>[(0,s._)("span",n,(0,o.zw)(g.blogTitle),1)])),footer:(0,s.w5)((()=>[(0,s._)("div",d,[(0,s.Wm)(c,{showComfirm:"",type:"danger",text:"删除",onComfirm:g.blogDel},null,8,["onComfirm"]),(0,s.Wm)(c,{type:"success",showComfirm:"",text:"发布",onComfirm:g.publish},null,8,["onComfirm"]),(0,s.Wm)(c,{type:"info",text:"编写",onComfirm:g.blogUpdate},null,8,["onComfirm"])])])),_:1})):(0,s.kq)("",!0)])),_:1})])),[[f,u.loading]])}var u=l(7580),g=l(506),h=l(835),m={name:"mylog-drafts",components:{CustomTable:g["default"]},data(){return{drafts:[],dialogVisible:!1,selectedBlogId:"",loading:!1,total:0,propMap:[{slot:!1,name:"title",width:200,label:"标题"},{slot:!1,name:"category",width:60,label:"分类"},{slot:!1,name:"intro",width:null,label:"简介"}]}},computed:{blogTitle(){const t=this.drafts.find((t=>t.id===this.selectedBlogId));return t?t.title:""}},beforeMount(){this.initBlogs()},activated(){},unmounted(){},methods:{initBlogs(){this.loading=!0,this.drafts.length=0,(0,u.$T)(0,10).then((t=>{const{total:e,rows:l}=t.data.data;this.total=e,this.drafts.push(...l)})).finally((()=>{this.loading=!1}))},selectRow(t,e,l){this.selectedBlogId=t.id,this.dialogVisible=!0},publish(){(0,u.FP)(this.selectedBlogId).then((t=>{t.data.status&&(this.initBlogs(),h.X.success("发布成功"))})).finally((()=>{this.dialogVisible=!1}))},blogDel(){(0,u.s0)({id:this.selectedBlogId}).then((t=>{t.data.status?(h.X.success("删除成功！"),this.initBlogs()):h.X.warning("删除失败！")})).catch((()=>{h.X.warning("删除失败！")})).finally((()=>{this.dialogVisible=!1}))},blogUpdate(){this.dialogVisible=!1,this.$router.push({name:"writting",params:{id:this.selectedBlogId,type:"draft"}})}}},c=l(89);const p=(0,c.Z)(m,[["render",r],["__scopeId","data-v-b470fe76"]]);var f=p}}]);
//# sourceMappingURL=793.f34ef8c2.js.map